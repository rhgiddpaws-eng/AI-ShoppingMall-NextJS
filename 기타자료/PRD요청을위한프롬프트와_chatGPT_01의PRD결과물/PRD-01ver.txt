# 1. 개요

본 프로젝트는 **Next.js** 기반의 쇼핑몰 MVP를 구축하는 것을 목표로 합니다. 
주요 레퍼런스 사이트로 **ASOS**를 참고하되, 
MVP 단계에서는 핵심 기능만 우선 구현합니다. 
특히 **LLM(Large Language Model) 기반 개발** 방식을 적용하여 
**AI가 주도적으로 개발 프로세스를 지원**하도록 설계합니다.

- **DB**는 **PostgreSQL**을 사용하며, 
**Prisma**를 통해 스키마를 자동 생성하고 
마이그레이션 과정을 간소화합니다.

- **pgvector**를 활용하여 상품 정보를 벡터 임베딩 후 
유사도 검색을 수행함으로써, **임베딩 기반 상품 추천** 기능을 구현합니다.

- 결제 시스템으로는 **토스페이먼츠(Toss Payments)**를 연동하고, 
결제 보안을 위해 **웹훅(Webhook)**을 적용합니다.

- 반응형 UI, **다크모드 지원**, 그리고 **매끄럽고 인터랙티브한 사용자 경험**을 제공하는 
고수준의 UI/UX를 목표로 합니다.

---

# 2. 주요 기능

## 2.1 홈페이지 및 네비게이션
1. **홈 화면**
   - 메인 배너(프로모션 이미지 등)와 대표 상품 목록 노출
   - 인기 상품/신상품 추천 섹션

2. **네비게이션 바**
   - 로고 및 사이트명, 카테고리별 이동 메뉴
   - 검색창(상품명, 카테고리 키워드 검색)
   - 로그인/회원가입/장바구니/마이페이지 바로가기

3. **카테고리별 필터**
   - 카테고리를 선택하면 해당 카테고리에 속한 상품 목록을 필터링
   - 사이즈, 색상, 가격대 등의 세부 필터링 고려 (MVP에서는 단순 카테고리 중심)

4. **검색 기능**
   - 상품명, 키워드 기반 검색
   - 검색 결과 페이지에서 카테고리, 가격 정렬 등의 추가 옵션 제공

5. **반응형 UI 및 다크모드 지원**
   - PC, 태블릿, 모바일 디바이스에 대응하는 레이아웃
   - 다크모드 스위치를 통해 사용자 테마 설정 가능

## 2.2 상품 상세 페이지
1. **기본 정보 표시**
   - 상품 이미지(슬라이드/갤러리), 가격, 상세 설명, 재고 상태

2. **추천 상품 목록**
   - pgvector를 활용하여 유사도 검색된 상품을 함께 노출
   - 상품 임베딩을 통해 연관성 높은 상품부터 순서대로 추천

3. **장바구니 담기 / 바로 구매**
   - 장바구니에 추가할 수 있는 버튼
   - 바로 구매 시 주문 페이지로 이동

## 2.3 장바구니 및 주문 기능
1. **장바구니**
   - 상품 추가/삭제/수량 변경
   - 장바구니 내 총 금액 표시

2. **주문 페이지**
   - 배송 정보(수령인, 주소, 연락처) 입력
   - 상품별 가격, 배송비, 총 결제 금액 표시   
   - **토스페이먼츠 결제** 연동
   
3. **결제 및 웹훅(Webhook)**
   - 토스페이먼츠 결제 처리 후 결제 성공/실패 상태 업데이트
   - 결제 정보(승인 번호, 금액 등) DB 저장
   - **웹훅**을 통해 결제/취소/환불 등의 상태를 안전하게 수신

## 2.4 사용자 관리
1. **회원가입 및 로그인**
   - 소셜 로그인(OAuth) 및 이메일 로그인 제공
   - 비밀번호 분실/재설정 기능
2. **프로필 관리**
   - 기본 프로필(닉네임, 프로필 이미지, 연락처 등) 수정
   - 주문 내역 조회, 반품/교환 신청(심화 기능은 MVP 이후 고려)

## 2.5 AI 상품 추천 시스템
1. **벡터 임베딩을 통한 상품 유사도 검색**
   - 상품명 또는 상품 특징을 OpenAI 등의 임베딩 API로 임베딩
   - pgvector를 통해 유사도 검색이 가능한 인덱스 관리
2. **추천 로직**
   - 상품 상세 페이지에서 비슷한 상품 제안
   - 홈/카테고리 페이지에서 인기 상품 + 연관 상품 노출

## 2.6 UI/UX 및 인터랙션
1. **프리미엄 웹 디자인 수준의 인터랙션**
   - 페이지 전환 시 애니메이션, 마우스 오버 시 동적 효과
   - 장바구니 담기/삭제 시 UI 피드백 (토스트 메시지, 모달 등)
2. **다크모드 및 사용자 친화적 디자인**
   - 사용자가 편의에 따라 테마를 변경할 수 있으며, 기본적으로 OS 테마와 동기화 가능
3. **접근성 고려**
   - 버튼 및 폰트 크기, 라벨링 등을 고려하여 모든 사용자에게 사용 편의 제공

---

# 3. 데이터 모델

다음은 주요 테이블 간 관계를 간략하게 나타낸 **ERD**와 주요 컬럼 설명입니다.

```
┌───────────────┐       ┌───────────────┐
│   User         │       │   Product     │
│───────────────│       │───────────────│
│ id (PK)       │       │ id (PK)       │
│ email         │       │ name          │
│ password      │       │ description   │
│ name          │       │ price         │
│ createdAt     │       │ stock         │
│ updatedAt     │       │ vector (pgvector) │
└───────────────┘       │ createdAt     │
                         │ updatedAt     │
                         └───────────────┘
                                
┌───────────────┐       ┌───────────────┐        ┌────────────────┐
│   Cart         │       │   Order       │        │  OrderItem     │
│───────────────│       │───────────────│        │────────────────│
│ id (PK)       │       │ id (PK)       │        │ id (PK)        │
│ userId (FK)   │       │ userId (FK)   │        │ orderId (FK)   │
│ createdAt     │       │ totalAmount   │        │ productId (FK) │
│ updatedAt     │       │ status        │        │ quantity       │
└───────────────┘       │ createdAt     │        │ price          │
             │          │ updatedAt     │        └────────────────┘
             │          └───────────────┘
┌───────────────┐
│  CartItem      │
│───────────────│
│ id (PK)       │
│ cartId (FK)   │
│ productId (FK)│
│ quantity      │
│ createdAt     │
│ updatedAt     │
└───────────────┘

┌─────────────────┐
│   Payment        │
│─────────────────│
│ id (PK)         │
│ orderId (FK)    │
│ paymentMethod   │
│ amount          │
│ status          │
│ transactionId   │
│ createdAt       │
│ updatedAt       │
└─────────────────┘
```

### 주요 테이블/컬럼 설명

1. **User**
   - `id`: Primary Key
   - `email`: 이메일 주소 (Unique)
   - `password`: 해시된 비밀번호 (소셜 로그인 시 null 가능)
   - `name`: 사용자 이름 / 닉네임
   - `createdAt`, `updatedAt`: 생성/수정 시간

2. **Product**
   - `id`: Primary Key
   - `name`, `description`: 상품 명, 상세 설명
   - `price`: 상품 가격
   - `stock`: 재고 수량
   - `vector`: 상품 임베딩 데이터(pgvector) 저장 컬럼
   - `createdAt`, `updatedAt`

3. **Cart**
   - `id`: Primary Key
   - `userId`: User 테이블과 1:1 또는 1:N(한 명이 복수 장바구니 생성 가능 여부) 관계
   - `createdAt`, `updatedAt`

4. **CartItem**
   - `id`: Primary Key
   - `cartId`: Cart 테이블과 N:1 관계
   - `productId`: Product 테이블과 N:1 관계
   - `quantity`: 장바구니 내 상품 수량
   - `createdAt`, `updatedAt`

5. **Order**
   - `id`: Primary Key
   - `userId`: 주문을 진행한 사용자
   - `totalAmount`: 총 결제 금액
   - `status`: 주문 상태(예: `PENDING`, `PAID`, `CANCELED` 등)
   - `createdAt`, `updatedAt`

6. **OrderItem**
   - `id`: Primary Key
   - `orderId`: Order 테이블과 N:1 관계
   - `productId`: Product 테이블과 N:1 관계
   - `quantity`: 주문 시 구매한 상품 수량
   - `price`: 구매 당시 상품 가격(변동 가격 고려 시 보존)
   - `createdAt`, `updatedAt`

7. **Payment**
   - `id`: Primary Key
   - `orderId`: Order 테이블과 1:1 관계
   - `paymentMethod`: 결제 방식(토스페이먼츠, 카드, 가상계좌 등)
   - `amount`: 결제 금액
   - `status`: 결제 상태(예: `WAITING`, `PAID`, `FAILED`)
   - `transactionId`: 외부 결제사에서 부여하는 거래 ID
   - `createdAt`, `updatedAt`

---

# 4. 기술 스택

1. **프론트엔드**
   - **Next.js (React 기반)**
   - React Query / SWR 등의 데이터 패칭 라이브러리
   - Tailwind CSS / Styled Components / Emotion 등 스타일링 라이브러리
   - React Hook Form(폼 처리), Headless UI(모달/셀렉트 등) 활용 가능
   - 다크모드 지원(Next-themes 등 라이브러리 고려)

2. **백엔드**
   - **Node.js** + **Next.js API Routes** (필요 시 서버리스 아키텍처로 확장)
   - **PostgreSQL** + **Prisma** (ORM)
   - AI 연동: **OpenAI 임베딩 API**(상품명/설명 임베딩 후 pgvector 저장)
   - **pgvector** 확장 기능 (PostgreSQL에서 유사도 검색)
   - 결제: **토스페이먼츠** API + **웹훅(Webhook)**

3. **인프라 및 DevOps**
   - Vercel 또는 AWS(EC2, RDS 등) 배포 고려
   - GitHub Actions 등을 통한 CI/CD 자동화
   - 보안: HTTPS 적용, OAuth 인증 시 JWT 사용 고려

4. **기타**
   - 애널리틱스: Google Analytics, Amplitude 등 추후 연동 가능
   - 이메일/알림: SendGrid, Nodemailer 등 추후 연동 가능

---

# 5. MVP 범위

## 5.1 반드시 포함할 기능
1. **홈페이지 및 네비게이션**: 카테고리/검색 기능, 다크모드, 반응형 UI
2. **상품 상세 페이지**: 이미지, 가격, 설명, 재고 상태, 장바구니 담기, **pgvector 기반 추천**
3. **장바구니 및 주문**: 장바구니 CRUD, 주문 작성, 배송 정보 입력
4. **결제 시스템**: **토스페이먼츠** 연동, 결제 성공/실패 여부 처리, **웹훅** 기반 상태 업데이트
5. **사용자 인증**: 이메일/비밀번호 로그인, 기본 프로필 관리
6. **AI 추천 시스템**: 상품 벡터 임베딩 및 유사도 추천(기본 로직)

## 5.2 제외(또는 MVP 이후 고려) 기능
1. **리뷰/평점 시스템**  
   - 상품 후기, 평점 관리 등은 2차 버전 이후 도입
2. **다양한 필터링 및 정렬 옵션**  
   - 사이즈, 색상, 가격대별 정렬 등은 MVP 이후 단계적으로 추가
3. **쿠폰 및 할인 코드**  
   - 할인 정책, 프로모션은 MVP 출시 후 업데이트
4. **고급 마이페이지 기능**  
   - 반품/교환 접수, 배송 추적, 적립금 관리 등은 추후 고려
5. **멀티 언어 지원**  
   - 국제화(i18n) 지원은 해외 진출 시점에 추가

---

본 PRD 문서를 바탕으로 MVP를 구현한 후, 사용자 피드백에 따라 추가 기능들을 점진적으로 확장해 나갈 계획입니다. 
**LLM 기반 개발** 프로세스를 최대한 활용하여, **AI 주도의 개발 파이프라인**을 구성하고 
효율적으로 프로젝트를 진행합니다.